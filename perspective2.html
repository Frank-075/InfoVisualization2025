<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Perspectief 2 – Beperkte impact EV-adoptie</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- D3  + Plotly -->
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>

  <!-- Fonts + favicon -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="icon" type="image/png" href="images/favicon.png" />

  <style>
    body{font-family:'Inter',sans-serif;background:#f3f4f6}
    .container{max-width:1000px}
    .section-title{border-bottom:2px solid #3b82f6;padding-bottom:.5rem;margin-bottom:1.5rem}
    .card{background:#fff;border-radius:.75rem;box-shadow:0 4px 6px rgba(0,0,0,.1);padding:1.5rem}
    .plot-container{background:#fff;border-radius:.75rem;box-shadow:0 2px 4px rgba(0,0,0,.05);padding:1rem;min-height:420px}
    .nav-link{padding:.75rem 1.25rem;border-radius:.5rem;transition:background .3s}
    .nav-link:hover{background:#e0f2fe}
    .nav-link.active{background:#bfdbfe;font-weight:600}
  </style>
</head>
<body class="antialiased text-gray-800">
<div class="container mx-auto p-6 lg:p-10 bg-white rounded-lg shadow-lg my-8 md:my-12">

  <!-- Navigatie -->
  <nav class="mb-8 p-4 bg-blue-700 text-white rounded-lg shadow-md flex flex-wrap justify-center gap-4">
    <a href="index.html"        class="nav-link">Introductie</a>
    <a href="dataset.html"      class="nav-link">Dataset&nbsp;&amp;&nbsp;Voorbewerking</a>
    <a href="perspective1.html" class="nav-link">Perspectief&nbsp;1</a>
    <a href="perspective2.html" class="nav-link active">Perspectief&nbsp;2</a>
    <a href="reflection.html"   class="nav-link">Reflectie&nbsp;&amp;&nbsp;Werkverdeling</a>
    <a href="results.html"      class="nav-link">Resultaten&nbsp;&amp;&nbsp;Conclusie</a>
  </nav>

  <!-- Inhoud -->
  <section class="mb-10 card">
    <h2 class="text-3xl font-semibold text-gray-800 section-title">
      Perspectief 2: Beperkte impact van EV-adoptie
    </h2>

    <p class="mb-6">
      Volgens dit perspectief is de bijdrage van EV’s aan de daling van CO₂-uitstoot minder doorslaggevend
      dan vaak wordt aangenomen. De visualisaties tonen (1) hoe de uitstoottendens per land niet uniform daalt en
      (2) hoe ongelijk de EV-penetratie in Europa momenteel is.
    </p>

    <!-- VIS 2.1 -->
    <h3 class="text-2xl font-medium text-gray-700 mt-6 mb-3">
      Visualisatie 2.1 – Evolutie CO₂-uitstoot per land
    </h3>
    <div id="co2EvolutionLineChart" class="plot-container"></div>

    <!-- VIS 2.2 -->
    <h3 class="text-2xl font-medium text-gray-700 mt-10 mb-3">
      Visualisatie 2.2 – EV-aandeel per land (interactieve kaart)
    </h3>
    <div id="evShareMap" class="plot-container"></div>
    <p class="text-sm text-gray-600 mt-4">
      Sleep de slider om te zien hoe de EV-penetratie zich sinds 2013 ontwikkelt. De kaart maakt duidelijk
      dat de hoge percentages vooral geconcentreerd zijn in één of twee landen, terwijl grote delen van Europa
      onder de 5&nbsp;% blijven – een indicatie dat de totale effect op CO₂-uitstoot voorlopig beperkt is.
    </p>
  </section>

  <!-- Footer -->
  <footer class="text-center text-gray-500 text-sm mt-12 pt-8 border-t border-gray-200">
    <p>&copy; 2025 Groep 12 – InfoVis Project.</p>
    <p class="mt-1"><a href="https://github.com/TygoHonig/InfoVisualization2025" target="_blank" class="text-blue-600 hover:underline">Broncode op GitHub</a></p>
  </footer>
</div>

<script>
/* ----------------- Bestands­paden ----------------- */
const carsCSV = 'data/cars_by_fuel.csv';
/* ----------------- Helpers ----------------- */
// Alpha-2 → Alpha-3 mapping voor EU / EER
const isoMap = {
  AT:'AUT', BE:'BEL', BG:'BGR', HR:'HRV', CY:'CYP', CZ:'CZE', DK:'DNK', EE:'EST',
  FI:'FIN', FR:'FRA', DE:'DEU', EL:'GRC', HU:'HUN', IE:'IRL', IT:'ITA', LV:'LVA',
  LT:'LTU', LU:'LUX', MT:'MLT', NL:'NLD', PL:'POL', PT:'PRT', RO:'ROU', SK:'SVK',
  SI:'SVN', ES:'ESP', SE:'SWE', NO:'NOR', IS:'ISL', LI:'LIE', CH:'CHE', UK:'GBR'
};
/* Kleurschaal (licht → donker groen) */
const colors = [['0','#eff6ff'],['0.2','#c7e9c0'],['0.4','#7fc97f'],
                ['0.6','#41ab5d'],['0.8','#238b45'],['1','#005824']];

Promise.all([d3.csv(carsCSV)])
.then(([carsRaw]) => {

  /* ---------- EV-aandeel per land-jaar ---------- */
  const byKey={};  // "geo-year" → {ELC,TOTAL}
  carsRaw.forEach(r=>{
    const key=`${r.geo}-${r.TIME_PERIOD}`;
    if(!byKey[key]) byKey[key]={geo:r.geo,year:+r.TIME_PERIOD,elc:0,total:0};
    if(r.mot_nrg==='ELC')   byKey[key].elc   = +r.OBS_VALUE;
    if(r.mot_nrg==='TOTAL') byKey[key].total = +r.OBS_VALUE;
  });
  const rows = Object.values(byKey)
               .filter(d=>d.total>0)
               .map(d=>({...d,evShare:d.elc/d.total*100, iso3:isoMap[d.geo]}))
               .filter(d=>d.iso3);   // verwijder niet-Europese codes

  /* ---------- VIS 2.1 – CO₂-lijn  (hergebruikt uit vorige versie) ---------- */
  // … hier ongewijzigd laten of lijn verwijderen, afhankelijk van je voorkeur
  //   (uit ruimte-overwegingen in dit antwoord niet opnieuw opgenomen)

  /* ---------- VIS 2.2 – Europa-choropleth ---------- */
  const years=[...new Set(rows.map(d=>d.year))].sort((a,b)=>a-b);
  const frames = years.map(yr=>{
    const yrRows = rows.filter(d=>d.year===yr);
    return {
      name:String(yr),
      data:[{
        type:'choropleth',
        locations:yrRows.map(d=>d.iso3),
        z:yrRows.map(d=>d.evShare),
        text:yrRows.map(d=>`${d.geo} – ${d.evShare.toFixed(2)} %`),
        colorscale:colors,
        zmin:0, zmax:30,
        colorbar:{title:'EV-aandeel %', ticksuffix:'%'},
        hovertemplate:'%{text}<extra></extra>'
      }]
    };
  });

  Plotly.newPlot('evShareMap', frames[0].data,{
    title:`EV-aandeel per land (${years[0]})`,
    geo:{scope:'europe', projection:{type:'natural earth'}, showframe:false, showcountries:true},
    margin:{t:60,r:0,b:10,l:0},
    sliders:[{
      steps:years.map(y=>({
        label:String(y),
        method:'animate',
        args:[[String(y)],{mode:'immediate',frame:{duration:500,redraw:false},
                           transition:{duration:300}}]
      })),
      pad:{t:30}, currentvalue:{prefix:'Jaar: ',font:{size:16}}
    }]
  },{responsive:true}).then(()=>Plotly.addFrames('evShareMap',frames));
})
.catch(err=>console.error('Data-load error',err));
</script>
</body>
</html>
